<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SipAI 营销活动魔法师 v2.0</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #f4f7f9; --primary-color: #007bff; --secondary-color: #6c757d;
            --success-color: #28a745; --warning-color: #ffc107; --text-primary: #212529;
            --text-secondary: #6c757d; --card-bg: #ffffff; --border-color: #dee2e6;
            --shadow: 0 4px 25px rgba(0, 0, 0, 0.08); --radius: 12px;
        }
        body { margin: 0; font-family: 'Noto Sans SC', sans-serif; background-color: var(--bg-main); color: var(--text-primary); }
        
        /* --- 整体布局 --- */
        .page-container { display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .input-wrapper { width: 100%; max-width: 960px; margin: 40px auto; padding: 0 20px; }
        .result-wrapper { display: none; width: 100%; max-width: 1360px; padding: 20px; flex-grow: 1; box-sizing: border-box; }
        .result-layout { display: flex; gap: 30px; }
        .main-content { flex-grow: 1; }
        .copilot-panel { width: 380px; flex-shrink: 0; background: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); display: flex; flex-direction: column; height: fit-content; position: sticky; top: 20px; }

        /* --- 输入与思考区 --- */
        .input-section { background: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); padding: 40px; text-align: center; }
        .thinking-section { display: none; text-align: center; padding: 40px 0; }
        .thinking-steps { display: flex; justify-content: center; gap: 20px; margin-top: 30px; flex-wrap: wrap; }
        .step { background: var(--card-bg); padding: 20px; border-radius: var(--radius); box-shadow: var(--shadow); width: 200px; opacity: 0; transform: translateY(20px); animation: popIn 0.5s forwards; }
        /* 省略部分与v1相同的CSS... */
        .input-section h1 { font-size: 28px; margin: 0 0 10px; }
        .input-section .slogan { font-size: 16px; color: var(--text-secondary); margin-bottom: 30px; }
        .prompt-input-wrapper { position: relative; }
        .prompt-input { width: 100%; padding: 18px 120px 18px 20px; font-size: 16px; border: 1px solid var(--border-color); border-radius: 30px; box-sizing: border-box; }
        .generate-btn { position: absolute; right: 8px; top: 8px; bottom: 8px; background: linear-gradient(45deg, #007bff, #0056b3); color: white; border: none; padding: 0 30px; border-radius: 25px; font-size: 16px; font-weight: 700; cursor: pointer; }
        .step .icon { font-size: 24px; margin-bottom: 10px; }
        .step .title { font-weight: 500; }
        .step .status { font-size: 14px; margin-top: 10px; font-weight: 700; }
        .status.done { color: var(--success-color); }
        @keyframes popIn { to { opacity: 1; transform: translateY(0); } }

        /* --- 结果展示区 --- */
        .result-header { text-align: center; margin-bottom: 30px; }
        .card { background: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); padding: 25px; margin-bottom: 30px; transition: all 0.5s ease-out; }
        .card.highlight { transform: scale(1.02); box-shadow: 0 8px 40px rgba(0, 123, 255, 0.2); }
        .card-title { font-size: 18px; font-weight: 700; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 20px; display: flex; align-items: center; }
        .card-title .icon { margin-right: 10px; font-size: 20px; }
        .prize-item, .budget-item { display: flex; align-items: center; margin-bottom: 15px; }
        
        /* --- Co-pilot 面板 --- */
        .copilot-header { padding: 20px; border-bottom: 1px solid var(--border-color); }
        .copilot-header h3 { margin: 0; text-align: center; font-size: 18px; }
        .copilot-messages { height: 400px; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        .copilot-message { max-width: 95%; line-height: 1.7; font-size: 14px; padding: 12px 18px; border-radius: var(--radius); }
        .copilot-message.user { background: #e9ecef; align-self: flex-end; }
        .copilot-message.bot { background: transparent; align-self: flex-start; }
        .copilot-input-area { padding: 20px; border-top: 1px solid var(--border-color); }
        .copilot-input { width: 100%; padding: 12px; font-size: 14px; border: 1px solid var(--border-color); border-radius: 8px; box-sizing: border-box; }
        
        /* 其他样式 */
        ul { padding-left: 20px; margin: 0; } li { margin-bottom: 10px; line-height: 1.6; }
        .text-preview { background: #f8f9fa; border: 1px solid var(--border-color); padding: 15px; border-radius: 8px; }
    </style>
</head>
<body>

    <div class="page-container">
        <!-- ===== 1. 输入与思考区 ===== -->
        <div id="initial-wrapper" class="input-wrapper">
            <section id="input-section" class="input-section">
                <h1>营销活动魔法师</h1>
                <p class="slogan">只需一句话，AI为您策划一场精彩的营销活动。您，只需拍板。</p>
                <div class="prompt-input-wrapper">
                    <input type="text" id="prompt-input" class="prompt-input" value="帮我策划一个针对华南地区、为期一周的扫码抽奖活动，预算五万，主打新品A。">
                    <button id="generate-btn" class="generate-btn">一键生成</button>
                </div>
            </section>
            <section id="thinking-section" class="thinking-section">
                <h2>AI正在为您生成方案...</h2>
                <div id="thinking-steps" class="thinking-steps"></div>
            </section>
        </div>

        <!-- ===== 2. 结果与交互区 ===== -->
        <div id="result-wrapper" class="result-wrapper">
            <div class="result-layout">
                <!-- 左侧主内容 -->
                <div class="main-content">
                    <div class="result-header">
                        <h2>华南地区新品扫码抽奖活动方案</h2>
                        <p class="summary">根据您的需求和预算，AI已为您生成以下完整方案，您可以通过右侧的AI助手进行修改。</p>
                    </div>
                    
                    <div id="rules-card" class="card">
                        <h3 class="card-title"><span class="icon">📜</span>活动规则</h3>
                        <ul id="rules-list">
                            <li><strong>活动时间：</strong>2024年8月1日 - 2024年8月7日 (为期一周)</li>
                            <li><strong>活动区域：</strong>华南地区 (广东、广西、海南)</li>
                            <li><strong>参与方式：</strong>活动期间，购买任意印有活动标识的“新品A”，扫描瓶盖内二维码即可参与抽奖。</li>
                        </ul>
                    </div>
                    
                    <div class="grid-container" style="grid-template-columns: 1fr 1fr; align-items: start;">
                        <div id="prizes-card" class="card">
                            <h3 class="card-title"><span class="icon">🎁</span>奖品设置</h3>
                            <div id="prizes-list">
                                <div class="prize-item"><span>🥇</span> <strong>一等奖：</strong>品牌定制旅行箱 (10份)</div>
                                <div class="prize-item"><span>🥈</span> <strong>二等奖：</strong>新品A一提 (100份)</div>
                                <div class="prize-item"><span>🥉</span> <strong>三等奖：</strong>1.88元现金红包</div>
                            </div>
                        </div>
                        <div id="budget-card" class="card">
                            <h3 class="card-title"><span class="icon">💰</span>预算分解</h3>
                            <div id="budget-list">
                                <div class="budget-item"><span>一等奖成本</span><strong>¥5,000</strong></div>
                                <div class="budget-item"><span>二等奖成本</span><strong>¥6,000</strong></div>
                                <div class="budget-item"><span>三等奖红包池</span><strong>¥37,500</strong></div>
                                <div class="budget-item"><span>总计</span><strong id="total-budget">¥48,500</strong></div>
                            </div>
                        </div>
                    </div>

                    <div id="text-card" class="card">
                        <h3 class="card-title"><span class="icon">✍️</span>推广文案 (AI生成)</h3>
                        <div id="text-preview" class="text-preview"><strong>【标题】</strong>「码」上开奖，即刻畅爽！...</div>
                    </div>
                </div>

                <!-- 右侧Co-pilot -->
                <aside class="copilot-panel">
                    <div class="copilot-header"><h3>方案优化 Co-pilot</h3></div>
                    <div id="copilot-messages" class="copilot-messages"></div>
                    <div class="copilot-input-area">
                        <input type="text" id="copilot-input" class="copilot-input" placeholder="输入您的修改指令...">
                    </div>
                </aside>
            </div>
        </div>
    </div>

<script>
    // --- DOM Elements ---
    const generateBtn = document.getElementById('generate-btn');
    const initialWrapper = document.getElementById('initial-wrapper');
    const resultWrapper = document.getElementById('result-wrapper');
    const copilotInput = document.getElementById('copilot-input');
    const copilotMessages = document.getElementById('copilot-messages');

    // --- State ---
    let budget = { prize1: 5000, prize2: 6000, prize3: 37500 };

    // --- Initial Generation Flow ---
    generateBtn.addEventListener('click', () => {
        // ... (与v1相同的思考过程动画代码，此处省略以保持简洁) ...
        const thinkingSection = document.getElementById('thinking-section');
        const inputSection = document.getElementById('input-section');
        inputSection.style.display = 'none';
        thinkingSection.style.display = 'block';
        setTimeout(() => {
            initialWrapper.style.display = 'none';
            resultWrapper.style.display = 'block';
            addCopilotMessage("方案已生成！您可以直接在下方输入框告诉我需要修改的地方，比如：“把一等奖换成最新款手机”", "bot");
        }, 1000); // 简化思考时间
    });

    // --- Co-pilot Interaction ---
    copilotInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && e.target.value.trim()) {
            const userInput = e.target.value.trim();
            addCopilotMessage(userInput, 'user');
            e.target.value = '';
            processUserInstruction(userInput);
        }
    });

    function addCopilotMessage(text, type) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `copilot-message ${type}`;
        msgDiv.textContent = text;
        copilotMessages.appendChild(msgDiv);
        copilotMessages.scrollTop = copilotMessages.scrollHeight;
    }

    function processUserInstruction(instruction) {
        let response = "好的，正在处理您的指令...";
        let modified = false;

        // 模拟AI理解并执行修改
        setTimeout(() => {
            if (instruction.includes('一等奖') && (instruction.includes('手机') || instruction.includes('iPhone'))) {
                updatePrize(1, '最新款旗舰手机 (2部)', 16000);
                response = "已将一等奖更新为“最新款旗舰手机”，并同步调整了预算。还有其他需要修改的吗？";
                modified = true;
            } else if (instruction.includes('时间') && instruction.includes('延长')) {
                updateRule('活动时间', '2024年8月1日 - 2024年8月14日 (延长至两周)');
                response = "好的，已将活动时间延长至两周。为保证预算充足，建议适当降低三等奖的中奖率哦。";
                modified = true;
            } else if (instruction.includes('文案') && (instruction.includes('活泼') || instruction.includes('年轻'))) {
                updateText('<strong>【标题】</strong> 玩真的！扫码就爆奖，手机大奖等你扛！<br><br><strong>【文案】</strong> 嘿，Z世代的弄潮儿！别再只是喝饮料了，来点刺激的！SipAI新品A，每一瓶都是一张通往欧皇的门票！扫码就有机会带走最新款手机，做朋友圈最靓的仔！#SipAI就玩大的');
                response = "没问题，已为您生成了更活泼、更年轻化的推广文案。";
                modified = true;
            } else {
                response = "抱歉，我暂时还没学会这个修改。您可以试试修改奖品、时间或者文案风格。";
            }
            addCopilotMessage(response, 'bot');
        }, 1000);
    }

    // --- Dynamic Update Functions ---
    function highlightCard(cardId) {
        const card = document.getElementById(cardId);
        card.classList.add('highlight');
        setTimeout(() => card.classList.remove('highlight'), 2000);
    }

    function updatePrize(level, newText, newCost) {
        const prizeList = document.getElementById('prizes-list');
        const item = prizeList.children[level - 1];
        if (item) {
            item.innerHTML = `<span>${level===1?'🥇':(level===2?'🥈':'🥉')}</span> <strong>${level===1?'一等奖':(level===2?'二等奖':'三等奖')}：</strong>${newText}`;
        }
        budget[`prize${level}`] = newCost;
        updateBudget();
        highlightCard('prizes-card');
        highlightCard('budget-card');
    }

    function updateRule(ruleName, newText) {
        const rulesList = document.getElementById('rules-list');
        for (let item of rulesList.children) {
            if (item.textContent.includes(ruleName)) {
                item.innerHTML = `<strong>${ruleName}：</strong>${newText}`;
                break;
            }
        }
        highlightCard('rules-card');
    }

    function updateText(newHtml) {
        document.getElementById('text-preview').innerHTML = newHtml;
        highlightCard('text-card');
    }

    function updateBudget() {
        const total = Object.values(budget).reduce((sum, val) => sum + val, 0);
        const budgetList = document.getElementById('budget-list');
        budgetList.children[0].children[1].textContent = `¥${budget.prize1.toLocaleString()}`;
        document.getElementById('total-budget').textContent = `¥${total.toLocaleString()}`;
    }
</script>

</body>
</html>